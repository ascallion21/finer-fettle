@page "/newsletter/footer"
@inject DisplayHelper DH
@inject NewsletterState AppState
@inject IOptions<SiteSettings> SiteSettings
@using Core.Models.Options
@using Microsoft.Extensions.Options
@using Core.Models.User

@if (AppState.User == null)
{
    return;
}

@if (AppState.User.TimeUntilDeload.TotalDays > 0)
{
    <div><small><b>Days Until Deload</b> - @AppState.User.TimeUntilDeload.TotalDays</small></div>
}

<div><small><b>Send Days</b> - @AppState.User.SendDays.GetSingleDisplayName()</small></div>
<div><small><b>Workout Split</b> - @AppState.User.Frequency.GetSingleDisplayName()</small></div>
@if (AppState.User.IsNewToFitness)
{
    <div><small><b>Is New to Fitness</b> - @AppState.User.IsNewToFitness</small></div>
}
else
{
    <div><small><b>Workout Intensity</b> - @AppState.User.IntensityLevel.GetSingleDisplayName()</small></div>
}

@if (AppState.User.RefreshFunctionalEveryXWeeks > 0)
{
    <div><small><b>Weeks Between Functional Refresh</b> - @AppState.User.RefreshFunctionalEveryXWeeks</small></div>
}
@if (AppState.User.RefreshAccessoryEveryXWeeks > 0)
{
    <div><small><b>Weeks Between Accessory Refresh</b> - @AppState.User.RefreshAccessoryEveryXWeeks</small></div>
}

<div><small><b>Sports Focus</b> - @AppState.User.SportsFocus.GetSingleDisplayName()</small></div>
@if (AppState.User.IncludeMobilityWorkouts)
{
    <div><small><b>Prehab Focus</b> - @AppState.User.PrehabFocus.GetSingleDisplayName()</small></div>
    <div><small><b>Rehab Focus</b> - @AppState.User.RehabFocus.GetSingleDisplayName()</small></div>
}

<div><small><b>Footnote Types</b> - @AppState.User.FootnoteType.GetDisplayName32()</small></div>
<div><small><b>Equipment</b> - <Lib.Pages.Shared.Exercise.Equipment UserEquipment="UserEquipment" AllEquipment="AllEquipment" /></small></div>

<div><small><b>Ignored Exercises</b> - @AppState.User.UserExercises.Count(ep => ep.Ignore) Selected</small></div>
<div><small><b>Ignored Variations</b> - @AppState.User.UserVariations.Count(ep => ep.Ignore) Selected</small></div>

@if (!AppState.User.Features.HasFlag(Features.Demo))
{
    <div style="margin-top:1ex;"><a target="_blank" href="@DH.UserLink("")">Manage Preferences</a></div>

    <hr style="margin-block:1ex;">
    <div><a href="@DH.UserLink("d")">Unsubscribe</a></div>

    <hr style="margin-block:1ex;">
    <div><a href="@SiteSettings.Value.WebLink/ImageAttribution">Image Attribution</a></div>

    <hr style="margin-block:1ex;">
    <div><a href="@SiteSettings.Value.WebLink/Terms">Terms of Use</a> | <a href="@SiteSettings.Value.WebLink/Privacy">Privacy</a></div>

    <hr style="margin-block:1ex;">
    <div><a href="mailto:help@@@SiteSettings.Value.Domain">Contact Us</a> | <a href="@SiteSettings.Value.Source">Source</a></div>
}
else
{
    @*
    <script>
        // Navigated back to the newsletter from the 'Too easy?'/'Too hard?' links. Refresh the demo content.
        if (!!window.performance && window.performance.navigation.type === 2) {
            // Refreshing the parent so the loading icon shows up
            window.parent.location.reload();
        }
    </script>
    *@
}

@code {
    [Parameter]
    public IList<ViewModels.Equipment.EquipmentViewModel> AllEquipment { get; set; } = null!;

    [Parameter]
    public IList<ViewModels.Equipment.EquipmentViewModel> UserEquipment { get; set; } = null!;
}